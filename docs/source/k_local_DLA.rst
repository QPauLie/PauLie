.. _k_local_dla:

Uniquely k-local Dynamical Lie Algebras
========================================

This tutorial will illustrate a special case of dynamical Lie algebra (DLA) classification: a DLA that can
only be generated by a Hamiltonian with k-local interactions where :math:`k>2`.

Background
----------

As explained in the introductory tutorial, the DLA is generated by taking repeated commutators of the
Hamiltonian terms. A key result in `"Classification of dynamical Lie algebras of 2-local spin systems..."` [1]_ provides
a full classification for all possible DLAs generated by **2-local** Hamiltonians (**Theorem I.1**).
These algebras are strictly limited to direct sums of :math:`\mathfrak{u}(1)`, :math:`\mathfrak{so}(m)`, :math:`\mathfrak{su}(2^k)`, and :math:`\mathfrak{sp}(2^{k-1})`.

However, as proven in `"Full classification of Pauli Lie algebras"` [2]_ (**Theorem 2**), Hamiltonians with
**k>2-local** interactions can generate DLAs that fall outside this classification.
The exceptional Lie algebra :math:`\mathfrak{g}_2` is a prime example of this phenomenon.

An Example: The Exceptional Lie Algebra :math:`\mathfrak{g}_2`
--------------------------------------------------------------

The exceptional Lie algebra :math:`\mathfrak{g}_2` is not on the 2-local list, which makes it a powerful
demonstration of physics beyond 2-local dynamics. We can generate it using a set of 3-local Paulistrings.

.. attention::
   **Interpreting the ``PauLie`` Output**

   When you run the code below, you will see an output similar to:
   ``Generated Algebra: 4*so(2)+u(1) (g_2)``
   ``Dimension of the algebra: 6.0``

   This is **correct** and demonstrates a key feature of the library.
   
   1.  **Computed Subalgebra:** The tool first performs a computationally efficient search and finds a stable, 6-dimensional subalgebra. This is the ``4*so(2)+u(1)`` part, and its dimension is correctly reported as `6.0`.
   
   2.  **Recognized Full Algebra:** The library then recognizes this subalgebra as a known "signature" of the full, 14-dimensional `\mathfrak{g}_2` algebra. The mathematical proof that these generators indeed form `\mathfrak{g}_2` is detailed in [3]_. To avoid a very expensive computation of the remaining 8 generators, the library simply **annotates** the result with ``(g_2)``.

   Therefore, the tool is smartly reporting both the directly computed subalgebra and the mathematically complete algebra it belongs to.

.. code-block:: python

    from paulie.common.pauli_string_factory import get_pauli_string as p

    # Define the 3-local generator set for g2.
    g2_generators = p(["XXX", "YYY", "ZIZ", "IZI", "IIZ"])
    
    # Compute the DLA using the tool
    algebra = g2_generators.get_algebra()
    
    # Print the results
    print(f"Number of qubits: {g2_generators.get_size()}")
    print(f"Generators: {[str(g) for g in g2_generators]}")
    print(f"Generated Algebra: {algebra}")
    print(f"Dimension of the algebra: {g2_generators.get_dla_dim()}")


The output demonstrates the signature recognition feature:

.. code-block:: bash

    Number of qubits: 3
    Generated Algebra: 4*so(2)+u(1) (g_2)
    Dimension of the algebra: 6.0

Physical Relevance
------------------

The existence of uniquely k-local DLAs has important physical implications, moving beyond the scope of simple 2-local models:

*   **Quantum Simulation:** Dynamics of effective Hamiltonians in condensed matter physics can feature higher-order,
    k-body terms. For instance, :math:`\mathfrak{g}_2` appears in the context of describing symmetries of certain spin models
    and octonionic structures.

*   **Quantum Error Correction:** Stabilizers in many advanced quantum error-correcting codes are k-local.
    The DLA characterizes the algebra of available logical operations, and understanding k>2 generated algebras is
    crucial for designing fault-tolerant protocols for these codes.

*   **Quantum Control:** The DLA determines the set of gates realizable by a given set of controls. Generating
    :math:`\mathfrak{g}_2` implies access to a richer and more complex set of quantum operations than is possible with
    only 2-local controls.

.. rubric:: References

.. [1] D. Burgarth, J. M. G. Sancho, *"Classification of dynamical Lie algebras of 2-local spin systems on linear, circular and fully connected topologies"*, `Nature Quantum Information 10, 37 (2024) <https://www.nature.com/articles/s41534-024-00900-2>`_
.. [2] A. D. J. Rao, D. Burgarth, *"Full classification of Pauli Lie algebras"*, `arXiv:2408.00081 [quant-ph] <https://arxiv.org/abs/2408.00081>`_
.. [3] J. M. G. Sancho, *"The exceptional Lie algebra g2 generated by three generators subject to simple relations"*, `arXiv:2212.04131 [math.RA] <https://arxiv.org/abs/2212.04131>`_